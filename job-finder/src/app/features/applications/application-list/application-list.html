<div class="p-6 bg-gray-50 min-h-screen">
  <h1 class="text-2xl font-bold mb-6">Suivi de mes candidatures</h1>

  <!-- Loader -->
  <div *ngIf="loading" class="flex flex-col items-center justify-center py-20">
    <div class="animate-spin rounded-full h-12 w-12 border-b-2 border-indigo-600"></div>
    <p class="mt-4 text-gray-500 font-medium">Chargement de vos candidatures...</p>
  </div>

  <!-- Grid Data -->
  <div *ngIf="!loading && applications.length > 0" class="grid gap-6">
    <div *ngFor="let app of applications" class="bg-white p-6 rounded-xl shadow-sm border border-gray-200 hover:shadow-md transition">
      <div class="flex justify-between items-start mb-4">
        <div>
          <h3 class="text-lg font-bold text-gray-900">{{ app.title }}</h3>
          <p class="text-indigo-600 font-medium">{{ app.company }}</p>
          <div class="flex items-center text-gray-400 text-xs mt-1">
            <svg class="h-3 w-3 mr-1" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path d="M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z"/><path d="M15 11a3 3 0 11-6 0 3 3 0 016 0z"/></svg>
            {{ app.location }}
          </div>
          <p class="text-[10px] text-gray-400 mt-2 uppercase font-bold tracking-wider">Ajoutée le {{ app.dateAdded | date:'dd MMM yyyy' }}</p>
        </div>

        <div class="flex flex-col items-end gap-3">
          <select [(ngModel)]="app.status" (change)="updateStatus(app, app.status)"
                  [className]="'text-xs font-bold p-2 rounded-lg border transition-colors ' +
                  (app.status === 'accepté' ? 'bg-green-50 text-green-700 border-green-200' :
                   app.status === 'refusé' ? 'bg-red-50 text-red-700 border-red-200' : 'bg-yellow-50 text-yellow-700 border-yellow-200')">
            <option value="en_attente">⏳ En attente</option>
            <option value="accepté">✅ Accepté</option>
            <option value="refusé">❌ Refusé</option>
          </select>
          <button (click)="deleteApp(app.id!)" class="text-red-400 hover:text-red-600 text-[11px] font-bold uppercase tracking-tight">
            Supprimer
          </button>
        </div>
      </div>

      <div class="mt-4 pt-4 border-t border-gray-50">
        <label class="block text-[10px] font-bold text-gray-400 uppercase mb-2">Notes personnelles</label>
        <textarea [(ngModel)]="app.notes"
                  class="w-full p-3 border border-gray-100 rounded-xl text-sm bg-gray-50 focus:bg-white focus:ring-2 focus:ring-indigo-500 outline-none transition-all"
                  placeholder="Écrivez vos notes ici (ex: date d'entretien...)"></textarea>
        <div class="flex justify-end mt-2">
          <button (click)="updateNotes(app)" class="text-xs bg-gray-900 text-white px-4 py-1.5 rounded-lg hover:bg-black transition">
            Enregistrer la note
          </button>
        </div>
      </div>
    </div>
  </div>

  <!-- Empty State -->
  <div *ngIf="!loading && applications.length === 0" class="text-center py-20 bg-white rounded-2xl border border-dashed border-gray-300">
    <p class="text-gray-500 text-lg">Vous ne suivez aucune candidature pour le moment.</p>
    <button routerLink="/jobs" class="mt-4 inline-flex items-center px-6 py-2 text-white bg-indigo-600 rounded-lg hover:bg-indigo-700 font-bold transition">
      Découvrir des offres
    </button>
  </div>
</div>
